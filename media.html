<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>视频页</title>
    <link rel="stylesheet" href="./assets/style/swiper.min.css">
    <link rel="stylesheet" href="./assets/style/common.css">
    <link rel="stylesheet" href="./assets/style/style.css">
    <link rel="stylesheet" href="./assets/style/detail_p.css">
    <link rel="stylesheet" href="./assets/style/font-awesome.min.css">
    <link rel="stylesheet" href="./assets/style/font-awesome-ie7.min.css">
</head>

<body>
    <header></header>

    <div class="media__container">
        <div class="media__wrap layout">
            <div class="media__wrap__content clearfix">
                <div class="media__video pull_left">
                    <div class="video_ls">
                        <video id="vids" src="assets/media/mov_bbb.mp4">
                            您的浏览器不支持h5标签,请升级或换个浏览器
                        </video>
                        <!--暂停-->
                        <div id="pass">
                            <img src="./assets/media/zt.png">
                        </div>
                        <!--控制器-->
                        <div class="controls">
                            <!--进度条容器-->
                            <div id="pBar">
                                <!--进度条底色-->
                                <div class="pBar_bj">
                                    <!--缓冲的进度条-->
                                    <div id="buff"></div>
                                    <!--进度条动态-->
                                    <div id="pBar_move">
                                        <!--进度条按钮-->
                                        <div id="pBtn"></div>
                                    </div>
                                </div>
                            </div>
                            <!--展厅播放快进快退音量全屏-->
                            <div class="trol_list">
                                <!--暂停和快进快退-->
                                <div class="list_1">
                                    <i class="iconfont  icon-backward icon-kuaitui-copy" onclick="ktui()"></i>
                                    <i class="iconfont  icon-stop icon-zanting2" id="ztbf"></i>
                                    <i class="iconfont  icon-forward icon-kuaijin" onclick="kjin()"></i>
                                </div>
                                <!--标题-->
                                <div class="title_top">
                                    开玩笑!不用摄影棚都能拍出"大师级"的作品?
                                </div>
                                <!--时间-->
                                <div class="vtime">
                                    <font id="nTime">00:00:00</font>/
                                    <em id="aTime">00:00:10</em>
                                </div>
                                <!--音量-->
                                <div class="voice">
                                    <i class="iconfont icon-yinliang" style="float:left;"></i>
                                    <div class="voicep hide">
                                        <div id="vBar">
                                            <div id="vBar_in"></div>
                                        </div>
                                        <div id="vBtn"></div>
                                    </div>
                                </div>
                                <!--全屏-->
                                <i id="qp" class="iconfont icon-fullscreen icon-quanping"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="media__info pull_right">
                    <h2>杨振宁，西南联大38级物理系</h2>
                    <h4>时间：2001年10月 地点：北京，清华大学</h4>
                    <p>
                        <span class="blue">访谈人：</span>请您谈谈抗战中“南迁”的情况。</p>
                    <p>
                        <span class="red">杨：</span>七七事变是1937年，在卢沟桥。 那个时候觉得卢沟桥非常之远，路不好，又没有交通工具，所以认为是郊外。我们住在清华园里头，听见枪声。那个时候是宋哲元，还有他的军队在跟日本有一些枪战。当然人心惶惶，不过那不是第一次。
                        1931年九一八事变以后，日本就不断地向华北这边进军。比如说，有一次他们打到了古北口，遇到国民党军队的抵制，他们又退了。可是他们最后的目的始终并没有放弃，然后又跟宋哲元要想搞什么“华北特区”这一类的事情。
                        在古北口那一次，北平当时很多人，包括清华大学的教授，到南方避难去了。我们家就在1933年，就是因为日本人快</p>
                    <span class="clearfix">
                        <a href="###" class="more pull_right">查看全文</a>
                    </span>
                </div>
            </div>
            <div class="media__wrap__list">
                <ul class="clearfix">
                    <li>
                        <div class="pic">
                            <a href="###">
                                <img src="./assets/image/3.jpg">
                            </a>
                        </div>
                        <div class="txt">
                            <a href="###">
                                <h4>李曦沐</h4>
                                <p>陈省身（Shiing Shen Chern），1911年10月 28日生于浙江嘉兴秀水县，美籍华裔数学大师、20 世纪最伟大的几何学家之一，[1-3] 生前曾长期 任教于美国加州大学伯克利分校（1960年起）、
                                    芝加哥大学（1949-1960年），并在伯克利建立了 美国国家数学科学研究所（MSRI）。 为了纪念陈 省身的卓越贡献..</p>
                            </a>

                        </div>
                    </li>
                    <li>
                        <div class="pic">
                            <a href="###">
                                <img src="./assets/image/3.jpg">
                            </a>
                        </div>
                        <div class="txt">
                            <a href="###">
                                <h4>李曦沐</h4>
                                <p>陈省身（Shiing Shen Chern），1911年10月 28日生于浙江嘉兴秀水县，美籍华裔数学大师、20 世纪最伟大的几何学家之一，[1-3] 生前曾长期 任教于美国加州大学伯克利分校（1960年起）、
                                    芝加哥大学（1949-1960年），并在伯克利建立了 美国国家数学科学研究所（MSRI）。 为了纪念陈 省身的卓越贡献..</p>
                            </a>

                        </div>
                    </li>
                    <li>
                        <div class="pic">
                            <a href="###">
                                <img src="./assets/image/3.jpg">
                            </a>
                        </div>
                        <div class="txt">
                            <a href="###">
                                <h4>李曦沐</h4>
                                <p>陈省身（Shiing Shen Chern），1911年10月 28日生于浙江嘉兴秀水县，美籍华裔数学大师、20 世纪最伟大的几何学家之一，[1-3] 生前曾长期 任教于美国加州大学伯克利分校（1960年起）、
                                    芝加哥大学（1949-1960年），并在伯克利建立了 美国国家数学科学研究所（MSRI）。 为了纪念陈 省身的卓越贡献..</p>
                            </a>

                        </div>
                    </li>
                    <li>
                        <div class="pic">
                            <a href="###">
                                <img src="./assets/image/3.jpg">
                            </a>
                        </div>
                        <div class="txt">
                            <a href="###">
                                <h4>李曦沐</h4>
                                <p>陈省身（Shiing Shen Chern），1911年10月 28日生于浙江嘉兴秀水县，美籍华裔数学大师、20 世纪最伟大的几何学家之一，[1-3] 生前曾长期 任教于美国加州大学伯克利分校（1960年起）、
                                    芝加哥大学（1949-1960年），并在伯克利建立了 美国国家数学科学研究所（MSRI）。 为了纪念陈 省身的卓越贡献..</p>
                            </a>

                        </div>
                    </li>
                </ul>
            </div>
        </div>

    </div>
    <footer></footer>
</body>
<script src="./js/jquery.min.js"></script>
<script src="./js/swiper.min.js"></script>
<script>
    $(document).ready(function () {
        $('header').load('./components/common-header.html');
        $('footer').load('./components/common-footer.html');


    });
    var vids = document.getElementById("vids");
    var sskd = $(".controls").width();/*替换原来的764*/
    /*一开始默认的视频路径（每个页面都会有一个默认的视频吧）*/
    var csdz = "media/";
    /*这一步判断他是什么浏览器，调用不同的格式的视频（这里以mp4为例子）*/
    var xzdz = "mov_bbb.mp4";
    vids.src = csdz + xzdz;
    /*点击右边的话替换左边视频的地址链接以及替换播放器的名字*/
    $(".one_tb").click(function () {
        $(this).addClass("on").siblings(".one_tb").removeClass("on");
        var hName = $(this).find("h3").html();
        var vid_src = $(this).attr("vid_src");
        $(".title_top").html(hName);
        vids.src = vid_src + xzdz;
        vids.play();
    })
    /*点击暂停图标的时候*/
    $("#pass").click(function () {
        $(this).css({ display: "none" });
        $("#ztbf").attr("class", "iconfont icon-pause")
        vids.play();
    });
    /*点击控制按钮里面的暂停图标的时候*/
    $("#ztbf").click(function () {
        if (vids.paused) {
            vids.play()
            $("#ztbf").attr("class", "iconfont icon-stop ")
        } else {
            vids.pause()
            $("#ztbf").attr("class", "iconfont icon-pause ")
        }
    })
    /*不论任何途径只要是暂停或者播放*/
    vids.onplay = function () {
        $("#pass").css({ display: "none" });
        $("#ztbf").attr("class", "iconfont icon-stop");
    }
    vids.onpause = function () {
        $("#pass").css({ display: "block" });
        $("#ztbf").attr("class", "iconfont icon-pause");
        $("#pBar").on('mouseup', function () {
            $(this).off('mousemove')
        })
    }
    /*时间转换器*/
    function numFormat(time) {
        time = parseInt(time);
        var h = addZero(Math.floor(time / 3600));
        var m = addZero(Math.floor((time % 3600) / 60));
        var s = addZero(Math.floor(time % 60));
        return h + ":" + m + ":" + s;
    }
    function addZero(num) {
        if (num < 10) {
            return "0" + num;
        } else {
            return '' + num;
        }
    }
    /*当前时间/总的时间(canplay方法开始)*/
    vids.oncanplay = function () {
        var aTime = numFormat(vids.duration);
        $("#aTime").html(aTime);
        /*第一步,进度条跟着时间动(鼠标点下的时候)*/
        vids.ontimeupdate = function () {
            sskd = $(".controls").width()
            var hc = (vids.buffered.end(0) / vids.duration) * sskd;
            $("#buff").css({ width: hc + 'px' })
            var nTime = numFormat(vids.currentTime);
            $("#nTime").html(nTime);
            /*当前的时间比上总的时间乘以总的长度*/
            var nLengh = (vids.currentTime / vids.duration) * (sskd - 20);
            $("#pBar_move").css({ width: nLengh + 'px' });
        }
        /*第二步,点击时的进度条*/
        $("#pBar").mousedown(function (e) {
            var cLk = e.clientX;/*点击距离(点击在进度条区域)*/
            var pJl = $("#pBar").offset().left;/*获取进度条距离左边的距离*/
            var mLengh = cLk - pJl;/*移动的距离*/
            if (mLengh >= (sskd - 20)) {
                mLengh = (sskd - 20)
            }
            $("#pBar_move").css({ width: mLengh + 'px' });/*改变进度条的距离*/
            var cTime1 = mLengh / (sskd - 20) * vids.duration;
            vids.currentTime = cTime1;
            var cTime2 = numFormat(cTime1);
            $("#nTime").html(cTime2);/*改变html的显示时间*/
            vids.play();
            /*---------------------------------鼠标拖拽的距离---------------------------------------*/
            $(document).on('mousemove', function (e) {
                vids.pause();
                var newLeft = e.clientX - pJl;/*拖拽的距离*/
                if (newLeft <= 0) {
                    newLeft = 0;
                }
                if (newLeft >= (sskd - 20)) {
                    newLeft = (sskd - 20)
                }
                var cTime3 = newLeft / (sskd - 20) * vids.duration;
                var cTime4 = numFormat(cTime3);
                $("#pBar_move").css({ width: newLeft + 'px' });
                vids.currentTime = cTime3;
                $("#nTime").html(cTime4);
            })/*拖拽结束*/
            /*----------------------------------鼠标松开----------------------------------------*/
            $("body").on('mouseup', function () {
                $(document).off('mousemove');
                vids.play();
            })/*松开结束*/
        })/*mousedown方法结束*/
    }/*(canplay方法结束)*/
    /*----------------------------------快进快退(点击html的时候)----------------------------------*/
    function ktui() {
        vids.currentTime -= 10;
    }
    function kjin() {
        vids.currentTime += 10;
    }
    /*----------------------------------快进快退(点击键盘的时候)----------------------------------*/
    $(document).keydown(function (event) {
        if (event.keyCode === 37) {
            vids.currentTime -= 10;
        }
        if (event.keyCode === 39) {
            vids.currentTime += 10;
        }
        /*----暂停播放(点击键盘空格的时候)----*/
        if (event.keyCode === 32) {
            if (vids.paused) {
                vids.play()
                $("#ztbf").attr("class", "iconfont icon-zanting")
            } else {
                vids.pause()
                $("#ztbf").attr("class", "iconfont icon-zanting2")
            }
        }
        /*-----------退出全屏-----------*/
        if (event.keyCode === 27) {
            $(".video_ls").removeClass("on");
            $(".controls").css({ width: "854px" })
        }
    })
    /*鼠标双击事件(双击播放器然后全屏)*/
    $(".video_ls").dblclick(function () {
        $(".video_ls").addClass("on");
        var oBox = $("body").width() - 66;
        $(".controls").css({ width: oBox + 'px' })
    });
    /*全屏播放按钮*/
    $("#qp").click(function () {
        if ($(".video_ls").hasClass("on")) {
            $(".video_ls").removeClass("on");
            $(".controls").css({ width: "854px" })
        } else {
            $(".video_ls").addClass("on");
            var oBox = $("body").width() - 66;
            $(".controls").css({ width: oBox + 'px' })
        }
    })


    /*音量加减*/

    vBtn.onmousedown = function (ev) {
        var ev = ev || window.event;
        var xs = ev.clientY - this.offsetTop;
        document.onmousemove = function (ev) {
            var newBottoms = ev.clientY - xs;
            if (newBottoms <= 0) {
                newBottoms = 0;
            } else if (newBottoms >= vBar.offsetHeight - vBtn.offsetHeight) {
                newBottoms = vBar.offsetHeight - vBtn.offsetHeight;
            }
            vBtn.style.bottom = -(newBottoms - 138) + "px";
            vBar_in.style.height = 138 - newBottoms + "px";
            var prop = Math.abs(newBottoms / (vBar.offsetHeight - vBtn.offsetHeight) - 1);
            console.log(prop);
            vids.volume = prop;
            //静音改变音量图标
            if (!vids.volume) {
                $(".icon-yinliang")[0].style.background = "url(./assets/media/m_voice.png)"
            } else {
                $(".icon-yinliang")[0].style.background = "url(./assets/media/voice.png)"
            }
        }
        document.onmouseup = function () {
            document.onmousemove = null;
            document.onmouseup = null;
        }
    }	
</script>

</html>